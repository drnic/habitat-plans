version: '2'

services:
  shield:
    image: starkandwayne/shield:edge
    command: "start starkandwayne/shield --peer database --bind database:postgresql.shield"
    links:
    - database
  agent:
    image: starkandwayne/shield-agent:edge
    command: "start starkandwayne/shield-agent --peer shield --bind daemon:shield.default"
    links:
    - shield
  database:
    image: starkandwayne/postgresql:edge
    command: "start starkandwayne/postgresql --group shield"
  tests:
    image: starkandwayne-shield-tests
    build: ./
    environment:
      AWS_ACCESS_KEY:
      AWS_SECRET_KEY:
      AWS_REGION:
      AWS_BUCKET:
      SHIELD_ENDPOINT: shield
      AGENT_ENDPOINT: agent
      PGHOST: database
      PGUSER: admin
      PGPASSWORD: admin
    links:
    - shield
    - database
